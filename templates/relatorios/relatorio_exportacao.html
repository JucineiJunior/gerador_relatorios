<!DOCTYPE html>
{% load custom_tags %}
<html lang="pt">
  <meta name="description" content="{{ titulo }}">
  <meta name="keywords" content="{{ colunas }}">
  <head>
    <title>{{ titulo }}</title>
  </head>
  <body>
    <style>
  @page {
        size: A4 {{orientacao}};
        margin: 20mm;
      }
  table {
    border-collapse: collapse;
    width: 100%;
    margin-bottom: 20px;
  }
  th, td {
    border: 1px solid #000;
    padding: 5px;
    text-align: left;
  }
  h3 {
    margin-top: 20px;
    margin-bottom: 5px;
  }
    </style>
    <h1>{{ titulo }}</h1>
    <p>Gerado em: {{ data_geracao }}</p>
    <ul>
      {% for filtro in filtros %}
        {% for x, y in parametros.items %}
          {% if filtro.variavel == x %}<li>{{ filtro.exibicao }}:{{ y }}</li>{% endif %}
        {% endfor %}
      {% endfor %}
    </ul>
    {% for grupo in grupos %}
      <!-- CabeÃ§alho do grupo (colunas de agrupamento) -->
      <h3>
        {% for valor in grupo.chave %}{{ valor }}{% endfor %}
      </h3>
      <!-- Tabela do grupo -->
      <table>
        <thead>
          <tr>
            {% for coluna in colunas %}
              {% if not coluna.agrupamento %}<th style="width: {{ coluna.largura }}px;">{{ coluna.coluna }}</th>{% endif %}
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for linha in grupo.linhas %}
            <tr>
              {% for coluna in colunas %}
                {% if not coluna.agrupamento %}<td>{{ linha|get_item:coluna.coluna }}</td>{% endif %}
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    {% endfor %}
  </body>
</html>
