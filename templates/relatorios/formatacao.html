{% extends "base.html" %}
{% load custom_tags %}
{% block content %}
  <div class="container border rounded m-5">
    <h2>Formatar colunas de {{ relatorio.nome }}</h2>
    <form method="post">
      {% csrf_token %}
      {{ formset.management_form }}
      {% for form in formset %}
        {% with colunas|index:forloop.counter0 as coluna %}
          <div class="container-fluid border rounded m-3 p-3">
            <h5 class="mb-3">{{ coluna|capfirst }}</h5>
            <div class="row">
              {% for field in form %}
                {% if not field.is_hidden %}
                  <div class="col-md-3 mb-3">
                    <label for="{{ field.id_for_label }}" class="form-label">{{ field.label }}</label>
                    {{ field }}
                    {% if field.errors %}<div class="invalid-feedback d-block">{{ field.errors.0 }}</div>{% endif %}
                  </div>
                {% else %}
                  {{ field }} {# hidden fields ainda precisam ser renderizados para POST #}
                {% endif %}
              {% endfor %}
            </div>
          </div>
        {% endwith %}
      {% endfor %}
      <button class="btn btn-success m-2" type="submit">Salvar colunas</button>
    </form>
  </div>
{% endblock content %}
